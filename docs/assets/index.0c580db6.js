import{m as e}from"./vendor.14b3b047.js";function t(e){if(console.assert(null!==e),null===e)throw new Error}document.title="DynalistやWorkFlowyのOPMLをTreeify用に変換";const r=document.querySelector("#form");t(r);const o=document.querySelector("#input-area");t(o);const n=document.querySelector("#output-area");t(n);const l={emStrong(e,t,r){const o=/^__(.+)__/.exec(e);return null!==o&&{type:"em",raw:o[0],text:o[1]}}},c={strong:e=>`<b>${e}</b>`,em:e=>`<i>${e}</i>`,del:e=>`<strike>${e}</strike>`};function s(r,o){const n=o.getAttribute("text");t(n);const l=a(e.parseInline(n)),c=l.querySelectorAll("a");for(const e of c)e.text!==e.href?e.replaceWith(...e.childNodes,` ${e.href} `):e.replaceWith(...e.childNodes);const s=l.querySelectorAll("img");for(const e of s)""===e.alt?e.replaceWith(e.src):e.replaceWith(`${e.alt} ${e.src}`);const i=l.querySelectorAll("*");for(const e of i)new Set(["b","u","i","strike"]).has(e.tagName.toLowerCase())||e.replaceWith(...e.childNodes);o.setAttribute("html",u(l));const m=o.getAttribute("_note");if(null!==m){const e=r.createElement("outline");e.setAttribute("text",m),o.prepend(e),o.removeAttribute("_note")}}function i(e,r){const o=r.getAttribute("text");t(o);const n=a(o),l=n.querySelectorAll("a");for(const t of l)t.text!==t.href?t.replaceWith(...t.childNodes,` ${t.href} `):t.replaceWith(...t.childNodes);const c=n.querySelectorAll("img");for(const t of c)""===t.alt?t.replaceWith(t.src):t.replaceWith(`${t.alt} ${t.src}`);const s=n.querySelectorAll("*");for(const t of s)new Set(["b","u","i","strike"]).has(t.tagName.toLowerCase())||t.replaceWith(...t.childNodes);r.setAttribute("html",u(n));const i=r.getAttribute("_note");if(null!==i){const t=e.createElement("outline");t.setAttribute("text",i),r.prepend(t),r.removeAttribute("_note")}}function a(e){const t=document.createElement("template");return t.innerHTML=e,t.content}function u(e){const t=document.createElement("dummy");return t.append(e),t.innerHTML}e.use({tokenizer:l,renderer:c}),o.addEventListener("input",(()=>{const e=(new DOMParser).parseFromString(o.value,"text/xml");if(e.getElementsByTagName("parsererror").length>0)""!==o.value?n.value="エラー：OPMLとして認識できません。":n.value="";else{for(const t of[...e.getElementsByTagName("outline")])switch(r.outlinerName.value){case"Dynalist":s(e,t);break;case"WorkFlowy":i(e,t)}n.value=function(e){const t=(new XMLSerializer).serializeToString(e.documentElement);return t.startsWith("<?xml")?t:'<?xml version="1.0"?>\n'+t}(e),n.focus({preventScroll:!0}),n.setSelectionRange(0,0)}}));
